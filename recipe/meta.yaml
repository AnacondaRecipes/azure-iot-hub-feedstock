{% set name = "azure-iot-hub" %}
{% set version = "2.6.0" %}

package:
  name: {{ name|lower }}
  version: {{ version }}

source:
  url: https://pypi.io/packages/source/{{ name[0] }}/{{ name }}/azure-iot-hub-{{ version }}.tar.gz
  sha256: ffc162c54a782a84215916c1fedf7e5d2432489db7fb2b581e2eddc800a3039e
  patches:
    # dos2unix needs by this reason: Hunk #1 FAILED at 77 different line endings.
    - patches/0001-Update-version-3.3-and-make-dos2unix.patch

build:
  number: 0
  script: {{ PYTHON }} -m pip install . -vv --no-deps --no-build-isolation
  # uamqp is not avaliable on py>312
  skip: True  # [py>312]
  # uamqp is not avaliable on linux py>311
  skip: True  # [linux and py>311]
  # uamqp is not avaliable on s390x
  skip: True  # [s390x]  

requirements:
  build: 
    - patch  # [not win]
    - m2-patch  # [win]
  host:
    - python
    - wheel
    - setuptools
    - pip
  run:
    - python
    - msrest >=0.6.21,<1.0.0
    - uamqp >=1.2.14,<2.0.0
    - azure-core >=1.10.0,<2.0.0

test:
  imports:
    - azure.iot.hub
  commands:
    - pip check
  requires:
    - pip

about:
  home: https://github.com/Azure/azure-iot-hub-python/
  summary: Microsoft Azure IoTHub Service Library
  license: MIT
  #license_file: LICENSE
  license_family: MIT
  dev_url: https://github.com/Azure/azure-iot-hub-python/
  doc_url: https://learn.microsoft.com/en-gb/python/api/azure-iot-hub/azure.iot.hub?view=azure-python
  description: The Azure IoTHub Service SDK for Python provides functionality for communicating with the Azure IoT Hub.

extra:
  recipe-maintainers:
    - snegireff
